<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>NOOR Canvas â€” Implementation Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        :root{
            --noor-primary:#0f766e; /* teal-700 */
            --noor-info:#0369a1; /* blue-700 */
            --noor-success:#16a34a; /* green-600 */
            --noor-warning:#f59e0b; /* amber-500 */
        }

        body { font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
        .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono'; }
        .metric-card { transition: transform .18s ease, box-shadow .18s ease; }
        .metric-card:hover { transform: translateY(-6px); box-shadow: 0 10px 20px rgba(2,6,23,0.08); }
        .status-badge.status-complete{ background: linear-gradient(90deg,var(--noor-success),#059669); color: #fff; border-radius: 999px }
        .status-badge.status-progress{ background: linear-gradient(90deg,#f59e0b,#fb923c); color:#fff; border-radius: 999px }
        .status-badge.status-pending{ background: #e5e7eb; color:#374151; border-radius: 999px }
        .task-complete{ background: #f0fdf4 }
        .task-pending{ color: #374151 }
        .fade-in{ opacity:0; transition: opacity .45s ease; }
        .pulse-success{ animation: pulse 2s infinite; }
        @keyframes pulse{ 0%{ transform:scale(1); } 50%{ transform:scale(1.01); } 100%{ transform:scale(1); } }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div class="max-w-7xl mx-auto p-6">
        <header class="mb-6">
            <h1 id="project-title" class="text-3xl font-extrabold">NOOR Canvas â€” Implementation Tracker</h1>
            <p id="project-subtitle" class="text-sm text-gray-600 mt-1">v3.0 â€¢ Real-time annotation system</p>
            <p id="start-date" class="text-xs text-gray-500 mt-1">Started: Sep 11, 2025</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6 fade-in">
                <h3 class="text-lg font-bold mb-3">Project Overview</h3>
                <p class="text-sm text-gray-600">NOOR Canvas v3.0 â€” Phased implementation tracker and execution dashboard.</p>
                <div class="mt-4 text-sm">
                    <div><strong>Main app:</strong> <code class="kbd">SPA/NoorCanvas</code></div>
                    <div class="mt-1"><strong>Test scaffold:</strong> <code class="kbd">Tests/NC-ImplementationTests/</code></div>
                </div>
            </div>

            <div id="metrics-container" class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </div>

        <!-- Critical Notice Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8 fade-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                <span class="mr-3">ðŸš¨</span>
                Critical Design Change Notice
            </h2>
            <div id="critical-notice" class="text-sm">
                <!-- Critical notice will be populated by JavaScript -->
            </div>
        </div>

        <!-- Top Priorities Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8 fade-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                <span class="mr-3">ðŸ”¥</span>
                Top Priorities (Next Sprint)
            </h2>
            <ol id="top-priorities" class="list-decimal list-inside text-sm space-y-2">
                <!-- Top priorities will be populated by JavaScript -->
            </ol>
        </div>

        <!-- Critical notice & priorities -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <div id="critical-section" class="bg-white rounded-xl shadow-lg p-6 fade-in">
                <!-- populated by JS -->
            </div>

            <div id="top-priorities-section" class="bg-white rounded-xl shadow-lg p-6 fade-in">
                <!-- populated by JS -->
            </div>
        </div>

        <!-- Phase 3.5 Actions & Action Backlog -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div id="phase35-actions-section" class="bg-white rounded-xl shadow-lg p-6 fade-in">
                <!-- populated by JS -->
            </div>

            <div id="action-backlog-section" class="bg-white rounded-xl shadow-lg p-6 fade-in">
                <!-- populated by JS -->
            </div>
        </div>

        <!-- Phases accordion -->
        <div class="space-y-6">
            <!-- Timeline & Milestones - Dynamic -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8 fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <span class="mr-3">â‰¡Æ’Ã´Ã </span>
                    Project Timeline & Key Milestones
                </h2>

                <div id="timeline-container" class="space-y-4">
                    <!-- Timeline will be populated by JavaScript -->
                </div>
            </div>

            <!-- Footer - Dynamic -->
            <footer class="text-center py-8">
                <div class="bg-gradient-to-r from-noor-primary to-noor-info rounded-xl p-6 text-white">
                    <p class="text-lg font-semibold mb-2">â‰¡Æ’Ã®Ã– NOOR Canvas v3.0 FINAL</p>
                    <p class="text-sm opacity-90">Islamic Content Sharing Platform â€¢ Real-time Annotation System</p>
                    <p id="last-updated" class="text-xs opacity-75 mt-2"></p>
                </div>
            </footer>
        </div>

    </div>

    <!-- â‰¡Æ’Ã¶Âº JAVASCRIPT ENGINE - Data-Driven Rendering -->
    <script>
        // Minimal data model used to render the tracker. This file is the presentation layer; update PROJECT_DATA in one place.
        const PROJECT_DATA = {
            title: 'NOOR Canvas',
            version: 'v3.0',
            subtitle: 'Real-time annotation system',
            startDate: 'Sep 11, 2025',
            timeline: '20 weeks',
            lastUpdated: 'September 12, 2025',
            currentPhase: 'Phase 3.5 â€” Mock-to-Live Integration',
            currentStatus: 'Replace mock implementations and apply DB migrations',
            progress: {
                overall: { percentage: 36.6, completed: 48, total: 131 },
                testing: { percentage: 32.8, completed: 41, total: 125 },
                phases: { completed: 3, total: 6, percentage: 50 }
            },
            criticalNotice: {
                title: 'Issue-17: Host Dashboard â†’ Direct Session Management UX Change',
                issue: 'Issue-17',
                description: 'Host authentication redirects directly to Session Management (no dashboard). Album â†’ Category â†’ Session cascading dropdowns (populated from KSESSIONS data). "Generate Session Token" and "Start Session" buttons for immediate action. Full integration with existing session security and API endpoints.',
                priority: 'HIGH',
                tracking: 'Issue-17-host-dashboard-to-direct-session-management-ux-change.md'
            },
            topPriorities: [
                'Phase 3.5 â€” Replace all mocks with live API calls and verify with integration tests (target: 3â€“5 working days)',
                'Apply EF Core migrations to AHHOME and validate schema & seeding (blocker for Phase 4)',
                'Implement Session lifecycle SignalR broadcasts (SessionBegan/SessionEnded) and late-join snapshot API',
                'Add CI workflow: lint â†’ build â†’ tests â†’ integration checks (fail fast on lint)'
            ],
            phase35Actions: [
                'Replace Session Creation Mock â†’ POST /api/host/session/create',
                'Replace Session Start/End Mock â†’ API integration',
                'Replace Participant Registration Mock â†’ Real API',
                'Replace Landing Page Authentication Mock',
                'Implement SessionBegan/SessionEnded broadcasts',
                'Add snapshot API: GET /api/sessions/{id}/state',
                'Create dedicated SQL login noor_canvas_app for production',
                'Execute EF Core migrations â†’ AHHOME server'
            ],
            actionBacklog: [
                'Convert one placeholder (Issue-20) into a runnable xUnit/bUnit test project',
                'Add CI workflow (GitHub Actions) that invokes test-runner-template.ps1',
                'Harden linting: add Razor/TS/JS linters in CI; keep lint-html.ps1 for docs',
                'Schedule migration window and a rollback plan for AHHOME'
            ],
            achievements: [
                'Core foundation: ASP.NET Core 8.0 + Blazor + SignalR',
                'Admin system & session management',
                'Real-time annotation system'
            ],
            dependencies: [
                { name: 'SQL Server Migration (AHHOME)', priority: 'critical', status: 'pending' },
                { name: 'Issue-15: Frontend-Backend API Integration', priority: 'high', status: 'pending' },
                { name: 'SignalR Broadcasting', priority: 'medium', status: 'pending' }
            ]
        };

        // MD-derived data (kept in sync with IMPLEMENTATION-TRACKER.MD)
        const MD_DATA = {
            criticalNotice: {
                issue: 'Issue-17',
                title: 'Host Dashboard â†’ Direct Session Management UX Change',
                description: 'Host authentication routes directly to Session Management; provide Generate Token and Start Session actions.'
            },
            topPriorities: [
                'Phase 3.5 â€” Replace all mocks with live API calls and verify with integration tests',
                'Apply EF Core migrations to AHHOME and validate schema & seeding',
                'Implement Session lifecycle SignalR broadcasts and late-join snapshot API',
                'Add CI workflow: lint â†’ build â†’ tests â†’ integration checks (fail fast on lint)'
            ],
            phase35Tasks: [
                'Connect CreateSession â†’ POST /api/host/session/create',
                'Connect StartSession â†’ POST /api/host/session/{id}/start',
                'Connect participant validation â†’ GET /api/participant/session/{guid}/validate',
                'Remove Task.Delay mocks and TODO stubs',
                'Implement SessionBegan/SessionEnded broadcasts',
                'Add snapshot API: GET /api/sessions/{id}/state'
            ],
            actionBacklog: [
                'Convert Issue-20 placeholder into xUnit/bUnit test project',
                'Add CI workflow (GitHub Actions) invoking test-runner template',
                'Harden linting: add Razor/TS/JS linters in CI'
            ],
            lastUpdated: 'September 12, 2025'
        };

        const PHASES_DATA = [
            { id: 'phase1', number: 1, title: 'Foundation', subtitle: 'Skeleton & infra', status: 'completed', progress: 100, description: 'Core infra, logging, DB, tools', completedDate: 'Sep 11, 2025', icon: 'â‰¡Æ’Ã´Ã ', categories: [ { name: 'Core', tasks: [{ name: 'Repo init', completed: true }, { name: 'ASP.NET Core project', completed: true }] } ] },
            { id: 'phase2', number: 2, title: 'Host & Participant Core', subtitle: 'Auth & registration', status: 'completed', progress: 100, description: 'Landing, auth, registration, waiting room', completedDate: 'Sep 11, 2025', icon: 'â‰¡Æ’Ã¦Ã‘', categories: [] },
            { id: 'phase3', number: 3, title: 'Annotations & Admin', subtitle: 'Advanced features', status: 'completed', progress: 100, description: 'Annotation tools, admin UI', completedDate: 'Sep 11, 2025', icon: 'â‰¡Æ’Ã„Â¿', categories: [] },
            { id: 'phase35', number: '3.5', title: 'Mock-to-Live Integration', subtitle: 'API & DB migration', status: 'in-progress', progress: 85, description: 'Replace mocks, implement SignalR events, apply migrations', targetDate: 'Oct 15, 2025', icon: 'â‰¡Æ’Ã¶Ã¤', categories: [] },
            { id: 'phase4', number: 4, title: 'Styling & Content Integration', subtitle: 'McBeatch & RTL', status: 'pending', progress: 0, description: 'Theme, RTL, content', icon: 'â‰¡Æ’Ã„Â¿', categories: [] },
            { id: 'phase5', number: 5, title: 'Performance & Accessibility', subtitle: 'Optimization & QA', status: 'pending', progress: 0, description: 'Performance tuning and WCAG', icon: 'Î“ÃœÃ­', categories: [] },
            { id: 'phase6', number: 6, title: 'Testing & Deployment', subtitle: 'Final tests & Go-Live', status: 'pending', progress: 0, description: 'Automated testing, deployment', icon: 'â‰¡Æ’ÃœÃ‡', categories: [] }
        ];

        const TIMELINE_MILESTONES = [
            { status: 'completed', date: 'Sep 11', title: 'Phases 1-3 Foundation Complete', description: 'Core infra and admin features' },
            { status: 'current', date: 'Oct 15', title: 'Phase 3.5: Mock-to-Live Integration', description: 'Replace mocks with real APIs' },
            { status: 'upcoming', date: 'Dec 25', title: 'Phase 4: Styling & Content Integration', description: 'McBeatch theme & content' },
            { status: 'target', date: 'Jan 29', title: 'Production Go-Live', description: 'Final deployment' }
        ];

        // Renderers
        function renderHeader() {
            document.getElementById('project-title').textContent = `â‰¡Æ’Ã®Ã– ${PROJECT_DATA.title}`;
            document.getElementById('project-subtitle').textContent = `${PROJECT_DATA.version} â€¢ ${PROJECT_DATA.subtitle}`;
            document.getElementById('start-date').textContent = `Started: ${PROJECT_DATA.startDate}`;
        }

        function renderMetrics() {
            const container = document.getElementById('metrics-container');

            const metrics = [
                { title: 'Overall Progress', value: `${PROJECT_DATA.progress.overall.percentage}%`, subtitle: `${PROJECT_DATA.progress.overall.completed}/${PROJECT_DATA.progress.overall.total} tasks`, color: 'noor-primary', gradient: 'from-noor-info to-noor-primary', width: PROJECT_DATA.progress.overall.percentage },
                { title: 'Testing Progress', value: `${PROJECT_DATA.progress.testing.percentage}%`, subtitle: `${PROJECT_DATA.progress.testing.completed}/${PROJECT_DATA.progress.testing.total} test cases`, color: 'noor-warning', gradient: 'from-yellow-400 to-orange-500', width: PROJECT_DATA.progress.testing.percentage },
                { title: 'Completed Phases', value: `${PROJECT_DATA.progress.phases.completed}/${PROJECT_DATA.progress.phases.total}`, subtitle: `${PROJECT_DATA.progress.phases.percentage}% phases done`, color: 'noor-success', gradient: 'from-green-400 to-green-600', width: PROJECT_DATA.progress.phases.percentage, pulse: true },
                { title: 'Current Status', value: PROJECT_DATA.currentPhase, subtitle: PROJECT_DATA.currentStatus, color: 'noor-info', gradient: 'from-blue-400 to-blue-600', width: 85 }
            ];

            container.innerHTML = metrics.map(metric => `
                <div class="metric-card rounded-xl p-6 shadow-lg fade-in ${metric.pulse ? 'pulse-success' : ''}">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm font-medium">${metric.title}</p>
                            <p class="text-3xl font-bold text-${metric.color} mt-1">${metric.value}</p>
                            <p class="text-xs text-gray-500 mt-1">${metric.subtitle}</p>
                        </div>
                        <div class="text-4xl">â‰¡Æ’Ã´Ã¨</div>
                    </div>
                    <div class="mt-4 bg-gray-200 rounded-full h-2">
                        <div class="progress-bar bg-gradient-to-r ${metric.gradient} h-2 rounded-full" style="width: ${metric.width}%"></div>
                    </div>
                </div>
            `).join('');
        }

        function renderPhases() {
            const container = document.getElementById('phases-container');
            // phased content is rendered into separate section when needed
        }

        function renderCriticalNotice() {
            const container = document.getElementById('critical-notice');
            const notice = PROJECT_DATA.criticalNotice;
            container.innerHTML = `
                <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg">
                    <h3 class="font-semibold text-red-800 mb-2">${notice.title}</h3>
                    <p class="text-red-700 mb-2"><strong>Issue:</strong> ${notice.issue}</p>
                    <p class="text-red-700 mb-2">${notice.description}</p>
                    <p class="text-red-700"><strong>Priority:</strong> ${notice.priority} | <strong>Tracking:</strong> ${notice.tracking}</p>
                </div>
            `;
        }

        function renderTopPriorities() {
            const el = document.getElementById('top-priorities-section');
            el.innerHTML = `
                <h3 class="text-lg font-bold mb-3">Top Priorities</h3>
                <ul class="list-disc list-inside text-sm space-y-2">
                    ${MD_DATA.topPriorities.map(priority => `<li>${priority}</li>`).join('')}
                </ul>
            `;
        }

        function renderPhase35Actions() {
            const el = document.getElementById('phase35-actions-section');
            el.innerHTML = `
                <h3 class="text-lg font-bold mb-3">Phase 3.5 Action Items</h3>
                <ul class="list-disc list-inside text-sm space-y-2">
                    ${MD_DATA.phase35Tasks.map(task => `<li>${task}</li>`).join('')}
                </ul>
            `;
        }

        function renderActionBacklog() {
            const el = document.getElementById('action-backlog-section');
            el.innerHTML = `
                <h3 class="text-lg font-bold mb-3">Action Backlog</h3>
                <ul class="list-disc list-inside text-sm space-y-2">
                    ${MD_DATA.actionBacklog.map(item => `<li>${item}</li>`).join('')}
                </ul>
            `;
        }

        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = TIMELINE_MILESTONES.map(m => {
                const statusColor = m.status === 'completed' ? 'green' : m.status === 'current' ? 'orange' : 'blue';
                return `
                <div class="flex items-center p-4 bg-${statusColor}-50 border-l-4 border-${statusColor}-500 rounded-r-lg">
                    <div class="flex-shrink-0 w-24 text-center">
                        <span class="text-xs text-${statusColor}-600 font-medium">${m.status.toUpperCase()}</span>
                        <p class="text-sm font-semibold text-${statusColor}-800">${m.date}</p>
                    </div>
                    <div class="ml-4">
                        <h4 class="font-semibold text-${statusColor}-800">${m.title}</h4>
                        <p class="text-sm text-${statusColor}-700">${m.description}</p>
                    </div>
                </div>
            `}).join('');
        }

        function renderCriticalNotice() {
            const el = document.getElementById('critical-section');
            el.innerHTML = `
                <h3 class="text-lg font-bold mb-3">Critical Notice</h3>
                <p class="text-sm text-red-700 font-semibold">${MD_DATA.criticalNotice.issue}: ${MD_DATA.criticalNotice.title}</p>
                <p class="text-sm text-gray-600 mt-2">${MD_DATA.criticalNotice.description}</p>
            `;
        }

        function renderPriorities() {
            const el = document.getElementById('priorities-section');
            el.innerHTML = `
                <h3 class="text-lg font-bold mb-3">Top priorities</h3>
                <ol class="list-decimal list-inside text-sm space-y-2">
                    ${MD_DATA.topPriorities.map(p => `<li>${p}</li>`).join('')}
                </ol>

                <h4 class="text-md font-semibold mt-4">Phase 3.5 action items</h4>
                <ul class="list-disc list-inside text-sm mt-2">
                    ${MD_DATA.phase35Tasks.map(t => `<li>${t}</li>`).join('')}
                </ul>

                <h4 class="text-md font-semibold mt-4">Action backlog</h4>
                <ul class="list-disc list-inside text-sm mt-2">
                    ${MD_DATA.actionBacklog.map(a => `<li>${a}</li>`).join('')}
                </ul>

                <p class="text-xs text-gray-500 mt-4">Last updated: ${MD_DATA.lastUpdated}</p>
            `;
        }
        function renderFooter() { document.getElementById('last-updated').textContent = `Last Updated: ${PROJECT_DATA.lastUpdated}` }

        document.addEventListener('DOMContentLoaded', function() {
            renderHeader(); renderMetrics(); renderTimeline(); renderFooter();

            // Animate fade-in
            setTimeout(()=> document.querySelectorAll('.fade-in').forEach((el,i)=> setTimeout(()=> el.style.opacity='1', i*80)), 80);

            // Render MD-derived sections
            renderCriticalNotice();
            renderTopPriorities();
            renderPhase35Actions();
            renderActionBacklog();
        });

        // Auto-refresh every 5 minutes
        setTimeout(()=> location.reload(), 300000);
    </script>
</body>
</html>
