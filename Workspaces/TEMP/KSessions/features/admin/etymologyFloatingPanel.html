<!-- Beautiful Etymology Floating Panel - Based on Etymology Panel.html Template -->
<!-- Overlay for closing when clicking outside -->
<div data-ng-show="vm.isVisible" 
     class="etymology-panel-overlay"
     data-ng-click="vm.closeWithoutInsertion()"></div>

<div data-ng-show="vm.isVisible"
     id="etymologyFloatingPanel"
     class="etymology-floating-panel-container"
     data-ng-class="{ 'loading': vm.isLoading }"
     data-ng-mousedown="vm.startDrag($event)"
     data-ng-mousemove="vm.drag($event)"
     data-ng-mouseup="vm.endDrag($event)">
    
    <div class="etymology-floating-panel-content"
         data-ng-click="$event.stopPropagation()">
        <!-- Header Section with Close Button -->
        <div class="etymology-panel-header"
             data-ng-mousedown="vm.startDrag($event)">
            <div class="etymology-header-left">
                <h2 class="etymology-panel-title">üåø Arabic Etymology</h2>
                <span class="etymology-database-info">{{ vm.databaseName || 'KQUR_DEV' }}</span>
            </div>
            <button type="button" 
                    class="etymology-close-button"
                    data-ng-click="vm.close()"
                    data-ng-mousedown="$event.stopPropagation()"
                    title="Close Etymology Panel">
                ‚úï
            </button>
        </div>
        
        <!-- Search Section -->
        <div class="etymology-search-section">
            <div class="etymology-search-container">
                <!-- Magnifying Glass Icon (Outside Input) -->
                <div class="etymology-search-icon-container">
                    <svg class="etymology-search-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </div>
                <!-- Input Field (No Internal Icon) -->
                <div class="etymology-search-input-group">
                    <input type="text" 
                           class="etymology-search-input"
                           data-ng-class="{ 'loading': vm.isLoading }"
                           data-ng-model="vm.searchQuery"
                           data-ng-model-options="{ debounce: 2000 }"
                           data-ng-change="vm.performSearch()"
                           placeholder="Search Roots, Derivatives, Meanings"
                           autofocus>
                </div>
                <!-- Clear Button -->
                <button type="button" 
                        class="etymology-clear-button"
                        data-ng-click="vm.clearSearch()"
                        data-ng-disabled="vm.isLoading">
                    Clear
                </button>
            </div>
        </div>
        
        <!-- Content Area -->
        <div class="etymology-content-area">
            
            <!-- Loading State -->
            <div data-ng-if="vm.isLoading" class="etymology-loading-state">
                <div class="etymology-loading-spinner">üåø</div>
                <div class="etymology-loading-text">Searching Etymology...</div>
                <div class="etymology-loading-subtext">Please Wait While We Search The Database</div>
            </div>
            
            <!-- Results Display -->
            <div data-ng-if="!vm.isLoading" class="etymology-results-container">
                
                <!-- Etymology Results -->
                <div data-ng-if="vm.etymologyDisplayData" class="etymology-details-card">
                    <div class="etymology-root-display">
                        <h1 class="etymology-root-arabic">{{ vm.etymologyDisplayData.root.root }}</h1>
                        <p class="etymology-root-transliteration" data-ng-if="vm.etymologyDisplayData.root.transliteration">({{ vm.etymologyDisplayData.root.transliteration | uppercase }})</p>
                        <p class="etymology-root-meaning">{{ vm.etymologyDisplayData.root.meaning }}</p>
                    </div>
                    
                    <div data-ng-if="vm.etymologyDisplayData.derivatives && vm.etymologyDisplayData.derivatives.length > 0" class="etymology-derivatives-section">
                        <h3 class="etymology-derivatives-title">Derivatives</h3>
                        <div class="etymology-derivatives-grid">
                            <div data-ng-repeat="derivative in vm.etymologyDisplayData.derivatives | limitTo:4 track by $index"
                                 class="etymology-derivative-card"
                                 data-ng-click="vm.onDerivativeClick(derivative)"
                                 data-ng-class="$index % 2 === 0 ? 'etymology-card-green' : 'etymology-card-lime'">
                                <span class="etymology-derivative-arabic">{{ derivative.arabicWord }}</span>
                                <p class="etymology-derivative-transliteration">({{ derivative.transliteration | uppercase }})</p>
                                <p class="etymology-derivative-meaning">{{ derivative.meaning }}</p>
                            </div>
                        </div>                        <!-- Additional derivatives if more than 4 -->
                        <div data-ng-if="vm.etymologyDisplayData.derivatives.length > 4" class="etymology-derivatives-grid etymology-additional-derivatives">
                            <div data-ng-repeat="derivative in vm.etymologyDisplayData.derivatives | limitTo:100:4 track by $index"
                                 class="etymology-derivative-card"
                                 data-ng-click="vm.onDerivativeClick(derivative)"
                                 data-ng-class="$index % 2 === 0 ? 'etymology-card-green' : 'etymology-card-lime'">
                                <span class="etymology-derivative-arabic">{{ derivative.arabicWord }}</span>
                                <p class="etymology-derivative-transliteration">({{ derivative.transliteration | uppercase }})</p>
                                <p class="etymology-derivative-meaning">{{ derivative.meaning }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Empty State -->
                <div data-ng-if="!vm.etymologyDisplayData && !vm.searchQuery" class="etymology-empty-state">
                    <div class="etymology-empty-icon">üåø</div>
                    <div class="etymology-empty-title">Welcome To Etymology Search</div>
                    <div class="etymology-empty-subtitle">
                        Enter An Arabic Word In The Search Box Above To Explore Its Linguistic Roots And Derivatives.
                    </div>
                    <div class="etymology-empty-suggestions">
                        Try Searching For: 
                        <span class="etymology-suggestion-link" data-ng-click="vm.searchSuggestion('ilah')">ÿ•ŸÑŸá</span>, 
                        <span class="etymology-suggestion-link" data-ng-click="vm.searchSuggestion('salam')">ÿ≥ŸÑÿßŸÖ</span>, Or 
                        <span class="etymology-suggestion-link" data-ng-click="vm.searchSuggestion('kitab')">ŸÉÿ™ÿßÿ®</span>
                    </div>
                </div>
                
                <!-- No Results State -->
                <div data-ng-if="!vm.etymologyDisplayData && vm.searchQuery" class="etymology-no-results-state">
                    <div class="etymology-no-results-icon">üîç</div>
                    <div class="etymology-no-results-title">Root Word Not Found.</div>
                    <div class="etymology-no-results-subtitle">
                        Please Try A Different Root Word From Our Database: ÿ•ŸÑŸá, ÿ≥ŸÑÿßŸÖ, ŸÉÿ™ÿßÿ®, ŸÅÿ±ÿ≠, Or ÿπŸÑŸÖ.
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>

<!-- Panel Overlay -->
<div class="etymology-panel-overlay" data-ng-show="vm.isVisible" data-ng-click="vm.close()"></div>
