<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>SSL Certificate Trust Configuration - Technical Reference | NOOR CANVAS Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="SSL Certificate Trust Configuration - Technical Reference | NOOR CANVAS Documentation ">
    
    
      <link rel="shortcut icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="NOOR CANVAS">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="ssl-certificate-trust-configuration---technical-reference">SSL Certificate Trust Configuration - Technical Reference</h1>

<p><strong>Purpose:</strong> Technical documentation for resolving SSL certificate trust issues in NOOR CANVAS development environment</p>
<p><strong>Audience:</strong> Developers, system administrators, DevOps engineers</p>
<p><strong>Last Updated:</strong> September 13, 2025</p>
<hr>
<h2 id="-problem-overview">üéØ <strong>Problem Overview</strong></h2>
<h3 id="issue-description"><strong>Issue Description</strong></h3>
<p>SSL certificate validation preventing Entity Framework database connections in development environment, causing authentication failures and application startup issues.</p>
<p><strong>Error Signature:</strong></p>
<pre><code>Microsoft.Data.SqlClient.SqlException: A connection was attempted to a database that is not available. The certificate chain was issued by an authority that is not trusted.
SSL Provider: The certificate chain was issued by an authority that is not trusted.
</code></pre>
<h3 id="impact-assessment"><strong>Impact Assessment</strong></h3>
<ul>
<li><strong>Authentication System:</strong> Host authentication completely non-functional</li>
<li><strong>Database Operations:</strong> All Entity Framework queries failing</li>
<li><strong>Application Startup:</strong> Successful server start but runtime database failures</li>
<li><strong>Development Workflow:</strong> Unable to test authentication flows locally</li>
</ul>
<hr>
<h2 id="-technical-solution">üîß <strong>Technical Solution</strong></h2>
<h3 id="ssl-certificate-bypass-configuration"><strong>SSL Certificate Bypass Configuration</strong></h3>
<p><strong>Implementation Approach:</strong> Configure SQL Server connection strings to bypass SSL certificate validation in development environment only.</p>
<h3 id="configuration-files-modified"><strong>Configuration Files Modified</strong></h3>
<h4 id="1-appsettingsdevelopmentjson-primary-fix"><strong>1. appsettings.Development.json</strong> (Primary Fix)</h4>
<pre><code class="lang-json">{
  &quot;ConnectionStrings&quot;: {
    &quot;DefaultConnection&quot;: &quot;Server=AHHOME;Database=KSESSIONS_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;Integrated Security=false;&quot;,
    &quot;KSessionsDb&quot;: &quot;Server=AHHOME;Database=KSESSIONS_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;Integrated Security=false;&quot;,
    &quot;KQurDb&quot;: &quot;Server=AHHOME;Database=KQUR_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;Integrated Security=false;&quot;
  }
}
</code></pre>
<h4 id="2-appsettingsjson-baseline-configuration"><strong>2. appsettings.json</strong> (Baseline Configuration)</h4>
<pre><code class="lang-json">{
  &quot;ConnectionStrings&quot;: {
    &quot;DefaultConnection&quot;: &quot;Server=AHHOME;Database=KSESSIONS_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;Integrated Security=false;&quot;,
    &quot;KSessionsDb&quot;: &quot;Server=AHHOME;Database=KSESSIONS_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;Integrated Security=false;&quot;,
    &quot;KQurDb&quot;: &quot;Server=AHHOME;Database=KQUR_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;Integrated Security=false;&quot;
  }
}
</code></pre>
<h3 id="key-parameters-explained"><strong>Key Parameters Explained</strong></h3>
<h4 id="trustservercertificatetrue"><strong>TrustServerCertificate=true</strong></h4>
<ul>
<li><strong>Purpose:</strong> Bypasses SSL certificate validation chain</li>
<li><strong>Effect:</strong> Accepts self-signed or untrusted certificates</li>
<li><strong>Security Impact:</strong> Acceptable for development environment only</li>
<li><strong>Production Usage:</strong> ‚ö†Ô∏è <strong>NEVER use in production without proper certificates</strong></li>
</ul>
<h4 id="encryptfalse"><strong>Encrypt=false</strong></h4>
<ul>
<li><strong>Purpose:</strong> Disables SQL Server connection encryption</li>
<li><strong>Effect:</strong> Reduces SSL overhead and certificate requirements</li>
<li><strong>Performance Impact:</strong> Slight improvement in development environment</li>
<li><strong>Production Usage:</strong> ‚ö†Ô∏è <strong>Should be true in production for security</strong></li>
</ul>
<h4 id="integrated-securityfalse"><strong>Integrated Security=false</strong></h4>
<ul>
<li><strong>Purpose:</strong> Uses SQL Server authentication instead of Windows authentication</li>
<li><strong>Effect:</strong> Relies on User Id/Password in connection string</li>
<li><strong>Compatibility:</strong> Required for cross-platform development</li>
<li><strong>Alternative:</strong> Can use Integrated Security=true with Windows authentication</li>
</ul>
<hr>
<h2 id="-implementation-steps">üõ† <strong>Implementation Steps</strong></h2>
<h3 id="step-1-update-development-configuration"><strong>Step 1: Update Development Configuration</strong></h3>
<pre><code class="lang-powershell"># Navigate to project directory
cd &quot;D:\PROJECTS\NOOR CANVAS\SPA\NoorCanvas&quot;

# Edit appsettings.Development.json
# Add SSL bypass parameters to all connection strings:
# - TrustServerCertificate=true
# - Encrypt=false
# - Integrated Security=false (if using SQL auth)
</code></pre>
<h3 id="step-2-verify-configuration-override"><strong>Step 2: Verify Configuration Override</strong></h3>
<pre><code class="lang-csharp">// In application startup, verify configuration loading
public static void Main(string[] args)
{
    var builder = WebApplication.CreateBuilder(args);
    
    // Development configuration should override base settings
    var connectionString = builder.Configuration.GetConnectionString(&quot;DefaultConnection&quot;);
    Console.WriteLine($&quot;Connection includes SSL bypass: {connectionString?.Contains(&quot;TrustServerCertificate=true&quot;)}&quot;);
}
</code></pre>
<h3 id="step-3-test-database-connectivity"><strong>Step 3: Test Database Connectivity</strong></h3>
<pre><code class="lang-powershell"># Start application in development environment
dotnet run --urls &quot;https://localhost:9091;http://localhost:9090&quot; --environment Development

# Verify no SSL certificate errors in application logs
# Look for successful Entity Framework queries
</code></pre>
<h3 id="step-4-validate-authentication-flow"><strong>Step 4: Validate Authentication Flow</strong></h3>
<pre><code class="lang-bash"># Test host authentication endpoint
curl -X POST https://localhost:9091/api/host/authenticate \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;hostGuid&quot;: &quot;XQmUFUnFdjvsWq4IJhUU9b9mRSn7YHuZql/JMWaxFrM=&quot;}' \
  -k  # -k flag ignores SSL certificate errors for testing
</code></pre>
<hr>
<h2 id="-testing--validation">üß™ <strong>Testing &amp; Validation</strong></h2>
<h3 id="automated-test-suite"><strong>Automated Test Suite</strong></h3>
<p><strong>Location:</strong> <code>Tests/NoorCanvas.Core.Tests/Infrastructure/SslConfigurationTestHarness.cs</code></p>
<pre><code class="lang-csharp">[Fact]
public void DefaultConnection_SslBypassConfiguration_ShouldConnectSuccessfully()
{
    // Validates SSL bypass parameters in connection string
    // Tests actual database connectivity
    // Verifies no SSL certificate errors
}
</code></pre>
<h3 id="manual-testing-checklist"><strong>Manual Testing Checklist</strong></h3>
<ul>
<li>[ ] Application starts without SSL certificate errors in logs</li>
<li>[ ] Host authentication accepts valid GUIDs without database errors</li>
<li>[ ] Entity Framework queries execute successfully</li>
<li>[ ] SignalR connections establish without certificate warnings</li>
<li>[ ] Performance remains acceptable (sub-5-second authentication)</li>
</ul>
<h3 id="performance-benchmarks"><strong>Performance Benchmarks</strong></h3>
<ul>
<li><strong>Authentication Response Time:</strong> &lt; 500ms (target &lt; 1000ms)</li>
<li><strong>Database Query Execution:</strong> &lt; 100ms for simple queries</li>
<li><strong>Application Startup Time:</strong> &lt; 30 seconds</li>
<li><strong>Memory Usage:</strong> Stable with no SSL-related memory leaks</li>
</ul>
<hr>
<h2 id="-security-considerations">üö® <strong>Security Considerations</strong></h2>
<h3 id="development-environment-only"><strong>Development Environment Only</strong></h3>
<p><strong>‚ö†Ô∏è CRITICAL:</strong> This SSL bypass configuration is <strong>ONLY</strong> suitable for development environments.</p>
<h3 id="production-requirements"><strong>Production Requirements</strong></h3>
<p>For production deployment:</p>
<pre><code class="lang-json">{
  &quot;ConnectionStrings&quot;: {
    &quot;DefaultConnection&quot;: &quot;Server=ProductionServer;Database=KSESSIONS;User Id=ProductionUser;Password=SecurePassword;Encrypt=true;TrustServerCertificate=false;&quot;
  }
}
</code></pre>
<h3 id="certificate-management-for-production"><strong>Certificate Management for Production</strong></h3>
<ol>
<li><strong>Install Valid SSL Certificates</strong> on production SQL Server</li>
<li><strong>Use Encrypt=true</strong> for data protection in transit</li>
<li><strong>Set TrustServerCertificate=false</strong> to enforce certificate validation</li>
<li><strong>Implement Certificate Rotation</strong> procedures</li>
<li><strong>Monitor Certificate Expiration</strong> dates</li>
</ol>
<hr>
<h2 id="-troubleshooting-guide">üîç <strong>Troubleshooting Guide</strong></h2>
<h3 id="common-ssl-certificate-errors"><strong>Common SSL Certificate Errors</strong></h3>
<h4 id="error-1-certificate-chain-not-trusted"><strong>Error 1: Certificate Chain Not Trusted</strong></h4>
<pre><code>The certificate chain was issued by an authority that is not trusted
</code></pre>
<p><strong>Solution:</strong> Add <code>TrustServerCertificate=true</code> to connection string</p>
<h4 id="error-2-certificate-name-mismatch"><strong>Error 2: Certificate Name Mismatch</strong></h4>
<pre><code>The target principal name is incorrect
</code></pre>
<p><strong>Solution:</strong> Verify server name in connection string matches SQL Server instance</p>
<h4 id="error-3-encryption-not-supported"><strong>Error 3: Encryption Not Supported</strong></h4>
<pre><code>Encryption is not supported on SQL Server
</code></pre>
<p><strong>Solution:</strong> Add <code>Encrypt=false</code> to disable encryption requirement</p>
<h3 id="diagnostic-commands"><strong>Diagnostic Commands</strong></h3>
<h4 id="test-raw-sql-connection"><strong>Test Raw SQL Connection</strong></h4>
<pre><code class="lang-powershell"># PowerShell test connection
$connectionString = &quot;Server=AHHOME;Database=KSESSIONS_DEV;User Id=sa;Password=adf4961glo;TrustServerCertificate=true;Encrypt=false;&quot;
$connection = New-Object System.Data.SqlClient.SqlConnection($connectionString)
try {
    $connection.Open()
    Write-Host &quot;‚úÖ Connection successful&quot;
    $connection.Close()
} catch {
    Write-Host &quot;‚ùå Connection failed: $($_.Exception.Message)&quot;
}
</code></pre>
<h4 id="check-sql-server-ssl-configuration"><strong>Check SQL Server SSL Configuration</strong></h4>
<pre><code class="lang-sql">-- Check SQL Server encryption settings
SELECT 
    name,
    value_in_use
FROM sys.configurations 
WHERE name LIKE '%encrypt%' OR name LIKE '%ssl%';

-- Verify certificate information
SELECT 
    certificate_id,
    name,
    subject,
    expiry_date
FROM sys.certificates;
</code></pre>
<h3 id="configuration-validation"><strong>Configuration Validation</strong></h3>
<pre><code class="lang-csharp">// Validate connection string parameters
public static bool ValidateSslBypassConfig(string connectionString)
{
    return connectionString.Contains(&quot;TrustServerCertificate=true&quot;, StringComparison.OrdinalIgnoreCase)
        &amp;&amp; connectionString.Contains(&quot;Encrypt=false&quot;, StringComparison.OrdinalIgnoreCase);
}
</code></pre>
<hr>
<h2 id="-monitoring--maintenance">üìä <strong>Monitoring &amp; Maintenance</strong></h2>
<h3 id="application-health-checks"><strong>Application Health Checks</strong></h3>
<pre><code class="lang-csharp">// Health check for database connectivity
public class DatabaseHealthCheck : IHealthCheck
{
    public async Task&lt;HealthCheckResult&gt; CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default)
    {
        try
        {
            // Test database connection without exposing SSL certificate errors
            await _context.Database.CanConnectAsync(cancellationToken);
            return HealthCheckResult.Healthy(&quot;Database connection successful&quot;);
        }
        catch (SqlException ex) when (ex.Message.Contains(&quot;certificate&quot;))
        {
            return HealthCheckResult.Unhealthy(&quot;SSL certificate configuration error&quot;, ex);
        }
    }
}
</code></pre>
<h3 id="logging-configuration"><strong>Logging Configuration</strong></h3>
<pre><code class="lang-csharp">// Enhanced logging for SSL-related issues
builder.Services.AddLogging(config =&gt;
{
    config.AddFilter(&quot;Microsoft.EntityFrameworkCore.Database.Connection&quot;, LogLevel.Information);
    config.AddFilter(&quot;Microsoft.Data.SqlClient&quot;, LogLevel.Warning);
});
</code></pre>
<hr>
<h2 id="-related-documentation">üîó <strong>Related Documentation</strong></h2>
<ul>
<li><strong>Issue-25:</strong> <a href="../../../IssueTracker/COMPLETED/Issue-25-host-authentication-failure-valid-guid.md">Host Authentication Failure with Valid GUID</a></li>
<li><strong>Implementation Tracker:</strong> <a href="../../../Workspaces/IMPLEMENTATION-TRACKER.MD">Phase 3 SSL Configuration</a></li>
<li><strong>Test Harnesses:</strong> <a href="../../../Tests/NoorCanvas.Core.Tests/Infrastructure/SslConfigurationTestHarness.cs">SSL Configuration Tests</a></li>
<li><strong>User Guide:</strong> <a href="../user-guides/host-authentication-guide.html">Host Authentication User Guide</a></li>
</ul>
<hr>
<h2 id="-change-log">üìù <strong>Change Log</strong></h2>
<h3 id="september-13-2025"><strong>September 13, 2025</strong></h3>
<ul>
<li><strong>Initial Documentation:</strong> Created comprehensive SSL configuration reference</li>
<li><strong>Test Suite:</strong> Implemented automated SSL configuration validation</li>
<li><strong>Issue Resolution:</strong> Completed Issue-25 with SSL bypass solution</li>
<li><strong>Production Notes:</strong> Added security considerations and production requirements</li>
</ul>
<h3 id="future-updates"><strong>Future Updates</strong></h3>
<ul>
<li>Production certificate installation procedures</li>
<li>Certificate rotation automation</li>
<li>Advanced SSL troubleshooting scenarios</li>
<li>Performance optimization for encrypted connections</li>
</ul>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/asifhussain60/NOOR-CANVAS/blob/master/DocFX/articles/technical/ssl-certificate-configuration.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      NOOR CANVAS Islamic Content Sharing Platform
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
